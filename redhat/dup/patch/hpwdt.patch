diff --git a/Makefile b/Makefile
new file mode 100644
index 0000000..bd25809
--- /dev/null
+++ b/Makefile
@@ -0,0 +1 @@
+obj-m += hpwdt.o
diff --git a/hpwdt.c b/hpwdt.c
index 3d77116..2c70253 100644
--- a/hpwdt.c
+++ b/hpwdt.c
@@ -27,6 +27,7 @@
 #include <linux/types.h>
 #include <linux/uaccess.h>
 #include <linux/watchdog.h>
+#undef CONFIG_HPWDT_NMI_DECODING
 #ifdef CONFIG_HPWDT_NMI_DECODING
 #include <linux/dmi.h>
 #include <linux/spinlock.h>
